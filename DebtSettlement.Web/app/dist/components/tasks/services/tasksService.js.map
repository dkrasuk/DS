{"version":3,"sources":["../../../../src/components/tasks/services/tasksService.js"],"names":["app","components","tasks","services","tasksService","global","$","utils","service","baseApiUrl","urlContent","getTask","id","when","ajax","url","type","duplicateTask","setTaskState","taskId","newState","comment","data","StateName","Comment","closeTask","prolongatePlannedDate","newDate","dateStr","format","date","Date","executeCommand","commandName","parameters","contentType","JSON","stringify","CommandName","Parameters","getAvailableCommands","getUserInfo","value","getActionInfo","actionId","getHistoryItem","historyId","window","jQuery"],"mappings":"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","file":"tasksService.js","sourcesContent":["ï»¿; var app = app || {};\r\napp.components = app.components || {};\r\napp.components.tasks = app.components.tasks || {};\r\napp.components.tasks.services = app.components.tasks.services || {};\r\napp.components.tasks.services.tasksService = (function (global, $, utils) {\r\n    var service = {};\r\n    function baseApiUrl() {\r\n        return utils.urlContent('/api/tasks/');\r\n    }\r\n\r\n    service.getTask = function (id) {\r\n        return $.when($.ajax({\r\n            url: baseApiUrl() + id,\r\n            type: 'GET'\r\n        }));\r\n    }\r\n\r\n    service.duplicateTask = function (id) {\r\n        return $.when(\r\n            $.ajax({\r\n                url: baseApiUrl() + id + '/duplicate',\r\n                type: 'PUT'\r\n            })\r\n        );\r\n    }\r\n\r\n    service.setTaskState = function (taskId, newState, comment) {\r\n        return $.when($.ajax({\r\n            url: baseApiUrl() + taskId + '/states',\r\n            type: 'PUT',\r\n            data: {\r\n                StateName: newState,\r\n                Comment: comment\r\n            }\r\n        }));\r\n    }\r\n\r\n    service.closeTask = function (id) {\r\n        return $.when($.ajax({\r\n            url: baseApiUrl() + id,\r\n            type: 'DELETE'\r\n        }));\r\n    }\r\n\r\n    service.prolongatePlannedDate = function (taskId, newDate, comment) {        \r\n        var dateStr = $.format.date(newDate, 'yyyy-MM-dd');\r\n        return $.when($.ajax({\r\n            url: baseApiUrl() + taskId + '/prolongate',\r\n            type: 'POST',\r\n            data: { Date: dateStr, Comment: comment || '' }\r\n        }));\r\n    }\r\n\r\n    service.executeCommand = function (taskId, commandName, parameters) {\r\n        return $.when($.ajax({\r\n            url: baseApiUrl() + taskId + '/commands',\r\n            type: 'PUT',\r\n            contentType: \"application/json\",\r\n            data: JSON.stringify({\r\n                CommandName: commandName,\r\n                Parameters: parameters\r\n            })\r\n        }));\r\n    }\r\n\r\n    service.getAvailableCommands = function (taskId) {\r\n        return $.when($.ajax({\r\n            url: baseApiUrl() + taskId + '/commands',\r\n            type: 'GET'\r\n        }));\r\n    }\r\n\r\n    service.getUserInfo = function (value) {\r\n        return $.when($.ajax({\r\n            url: utils.urlContent('/api/users/') + value,\r\n            type: 'GET'\r\n        }));\r\n    }\r\n\r\n    service.getActionInfo = function (type, actionId) {\r\n        return $.when($.ajax({\r\n            url: utils.urlContent('/api/agreements/actions/' + type + '/' + actionId),\r\n            type: 'GET'\r\n        }));\r\n    }\r\n\r\n    service.getHistoryItem = function(taskId, historyId) {\r\n        return $.when($.ajax({\r\n            url: baseApiUrl() + taskId + '/history/' + historyId,\r\n            type: 'GET'\r\n        }));\r\n    }\r\n\r\n    return service;\r\n}(window, jQuery, app.utils));"]}